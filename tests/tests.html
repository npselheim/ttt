<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>cell4 Unit Tests</title>
		<link rel="stylesheet" href="../lib/qunit-1.11.0.css">
		<script src="../lib/jquery-1.8.2.js"></script>
		<script src="../lib/qunit-1.11.0.js"></script>
		<script src="../app/javascripts/src/ttt/main.js"></script>
		<script src="../app/javascripts/src/ttt/cell.js"></script>
		<script src="../app/javascripts/src/ttt/grid.js"></script>

	</head>
	<body>
		<div id="qunit"></div>
		<div id="qunit-fixture"></div>
		<script>
			var cell4, cell5, grid;

			module( "Cell Tests", {
				setup: function() {
					cell4 = new MyApp.Cell( 4 );
				},
				teardown: function() {
					cell4 = null;
					cell5 = null;
				}
			});
			test( "cell can be created", function() {
				expect( 1 );
				deepEqual( typeof cell4, 'object', "Verify that cell is an object)" );
			});
			test( "cell is an instance of MyApp.Cell", function() {
				expect( 1 );
				deepEqual( cell4 instanceof MyApp.Cell, true, "should be an instance of MyApp.Cell" );
			})
			test( "New cell object is not marked", function() {
				expect( 1 );
				deepEqual( cell4.isMarked(), false, "new cell should not be marked" );
			});
			test( "setting a mark marks the cell", function() {
				expect( 1 );
				cell4.setMark('X');
				deepEqual( cell4.isMarked(), true, "cell should be marked after mark is set" );
			});
			test( "can call showWin", function() {
				expect( 1 );
				cell4.showWin();
				ok(true);
			})
			test( "reset unmarks the cell", function() {
				expect( 2 );
				cell4.setMark( 'O' );
				deepEqual( cell4.isMarked(), true, "cell is marked when mark is set" );
				cell4.reset();
				deepEqual( cell4.isMarked(), false, "cell should not be marked after reset" );
			});
			test( "get the mark from the cell", function() {
				expect( 1 );
				cell4.setMark( 'X' );
				deepEqual( cell4.getMark(), 'X', "should get back the same mark" );
			})
			test( "cannot access the mark directly", function() {
				expect(1);
				cell4.setMark( 'O' );
				deepEqual( typeof cell4.mark, 'undefined', "should not see the private variable" );
			})
			test( "index outside 0-8 throws an error", function() {
				expect( 1 );
				throws( function() {
					var cell9 = new MyApp.Cell( 9 );
				}, "index out of 0-8 range throws Error exception");
			});
			test( "illegal mark throws an error", function() {
				expect( 1 );
				throws( function() {
					cell4.setMark( 'A' );
				}, "throw an error if not 'X' or 'O'" );
			});
			test( "cell instances are independent", function() {
				expect( 3 );
				cell5 = new MyApp.Cell( 5 );
				cell4.setMark( 'X' );
				cell5.setMark( 'O' );
				deepEqual( cell4.getMark(), 'X', "cell4 is still X" );
				cell4.reset();
				ok( !cell4.isMarked(), "cell4 has been reset" );
				deepEqual( cell5.getMark(), 'O', "cell5 is still O");
			})

			// module( "cells Tests" );
			// test( "cells collection can be created", function() {

			// })

			// module( "Player Tests" );
			// test( "Player can be created", function() {
			// 	expect( 1 );
			// 	var playerX = new Player( 'X' );
			// 	ok (playerX instanceof Player, 'object', "verify the player is created" );
			// });
			// test( "creating a player with an illegal mark throws an error", function() {
			// 	expect( 1 );
			// 	throws( function() {
			// 		var playerA = new Player( 'A' );
			// 	}, "throw an error if not 'X' or 'O'");
			// });
			// test( "can get player's token", function() {
			// 	expect( 1 );
			// 	var playerX = new Player( 'X' );
			// 	deepEqual( playerX.mark, 'X', "player's mark should be X" );
			// });
			// test( "player instances return correct values", function() {
			// 	expect( 4 );
			// 	var playerX = new Player( 'X' );
			// 	var playerO = new Player( 'O' );
			// 	deepEqual( 88, playerX.markValue, "value of X is 88" );
			// 	deepEqual( 79, playerO.markValue, "value of O is 79" );
			// 	deepEqual( 88 * 3, playerX.winValue, "winning total for X is 264" );
			// 	deepEqual( 79 * 3, playerO.winValue, "winning total for O is 237" );
			// });

			module( "Grid Tests", {
				setup: function() {
					grid = MyApp.grid;
				}, 
				teardown: function() {
				}
			});

			test( "Can reference the grid object", function() {
				expect( 1 );
				ok( typeof grid, 'object', "grid should be an object" );
			});
			test( "grid should have 9 cells", function() {
				expect( 1 );
				deepEqual( grid.cells.length, 9, "grid should have 9 cells");
			});
			test( "Can mark a cell with 'X'", function() {
				expect( 1 );
				console.log("Attempting to mark cell 1");
				grid.update( 1, 'X' );
				deepEqual( grid.cells[1].getMark(), 'X', "cell1 should contain an 'X'");
			});


		</script>
	</body>
</html>